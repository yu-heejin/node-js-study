## Node.js란?

- 구글의 V8 자바스크립트 엔진에 기반한다.
- 싱글스레드 기반 비동기 이벤트 위주 IO를 사용하는 고도의 확장성을 가진 시스템이다.
- 간단한 작업을 수행하지만 빈도가 높은 웹 애플리케이션에 이상적이다.

### 특징

- 싱글 스레드 : 문맥 교환으로 인한 오버헤드 X
- 비동기 IO : CPU time loss를 피함, IO 요청이 있으면 워커에게 던지고 스레드는 다른 일을 계속 받는다.
- 이벤트 기반 : epool 또는 kqueue를 사용
- 경량 프레임워크
- 풍부한 라이브러리 : 각종 모듈
- 서버와 클라이언트에서 사용하는 언어가 같다(js)

## 아키텍처

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9a6af945-cbdb-4e5d-8534-02253df03415/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3ed07f8c-8d43-4084-a637-c7c17e5bbfb9/Untitled.png)

- 상위 레벨은 자바스크립트로 되어 있고, 로우 레벨은 C, C++로 짜여 있다.

## 싱글 스레드만 사용하는가?

- 싱글 스레드 기반의 이벤트 루프가 계속 돌면서 요청을 처리한다.
- IO 요청이 있는 경우, 스레드 풀에 던져둔다.
    - 여기에는 워커들이 여러개 있으며, 사용자가 작성할 때가 싱글 스레드이다.
- 즉, **이벤트 루프만 싱글 스레드라서 req, res가 싱글 스레드인거지 뒤에서 열심히 일하는 워커(io처리 등)들은 여러개(멀티 스레드)이다.**
- 이벤트 루프만 블로킹되지 않게 만들면 워커들은 알아서 일 나눠서 돌아간다.
- 싱글 스레드 멀티 플렉싱으로 해결한다.

## 비동기의 장점?

- 동기식 IO에서는 디스크에 파일 쓰기 요청이 들어오면, 디스크가 파일 쓰는 동안에 CPU가 논다.
- 비동기는 저러한 요청이 들어오면 워커에게 일을 넘긴다. CPU는 쉬지 않고 다른 요청들을 받는다. → CPU 효율

## 참고 자료

- [https://sjh836.tistory.com/79](https://sjh836.tistory.com/79)