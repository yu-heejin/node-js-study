## OS 모듈 - 코어 개수 확인하기

- os.cpus().length를 하면 코어의 개수가 숫자로 나온다.
- 하지만, 노드에서 싱글 스레드 프로그래밍을 하면 코어가 몇 개든 상관없이 대부분의 경우 코어를 하나밖에 사용하지 않는다.
- cluster 모듈을 사용하는 경우 코어 개수에 맞춰서 프로세스를 늘릴 수 있다.
    - 이때 cpus() 메서드를 사용한다.

## path

- 폴더와 파일의 경로를 쉽게 조작하도록 도와주는 모듈
- path 모듈이 필요한 이유는 운영체제별로 경로 구분자가 다르기 때문이다.
- 이 외에도 파일 경로에서 파일명이나 확장자만 따로 떼어주는 기능도 구현하기 때문에 직접 구현하지 않고도 편리하게 사용할 수 있다.
- 가끔 윈도우에서 POSIX 스타일 경로를 사용할 때가 있고, 그 반대일 때도 있다.
    - 이러한 경우 **윈도우에서는 path.posix.sep이나 path.posix.join()**과 같이 사용하면 되고, **POSIX에서는 path.win32.sep이나 path.win32.join()**과 같이 사용하면 된다.
- 노드는 require.main 파일을 기준으로 상대경로를 인식한다.
    - 따라서 require.main과는 다른 디렉터리의 파일이 상대경로를 가지고 있다면 예상과 다르게 동작할 수 있다.

### join vs resolve

- path.join과 path.resolve 메서드는 비슷해보이지만 동작 방식이 다르다.
- / 를 만나면 path.resolve는 절대 경로로 인식해서 앞의 경로를 무시하고 path.join은 상대경로로 처리한다.
    
    ```jsx
    path.join('/a', '/b', 'c');   // /a/b/c/
    path.resolve('/a', '/b', 'c');  // /b/c
    ```
    

## url

- 인터넷 주소를 쉽게 조작하도록 도와주는 모듈
- url 처리에는 크게 두 가지 방식이 있다.
    1. **노드 버전 7에서 추가되는 WHATWG(웹 표준을 정하는 단체 이름)방식의 url** → 요즘 많이 사용
        1. **브라우저에서도 해당 방식을 사용하기 때문에 호환성이 좋다.**
    2. 예전부터 노드에서 사용하던 방식의 url
- 주소가 host 부분 없이 pathname 부분만 오는 경우(ex. /book/bookList.apsx), WHATWG 방식은 해당 주소를 처리할 수 없다.
    - 만약 host부분 없이 pathname만 있는 경우 두 번째 인수로 host를 적어줘야 한다.
        
        ```tsx
        new URL('/book/bookList.aspx', 'https://www.gilbut.co.kr');
        ```
        

### WHATWG과 노드의 주소 체계

- 주소의 각 부분별 명칭은 다음과 같다.
    
    ![KakaoTalk_Photo_2023-03-20-10-13-22.jpeg](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/08e1be02-2203-49d2-8abd-6d1b8d6e6358/KakaoTalk_Photo_2023-03-20-10-13-22.jpeg)
    
- search 부분(쿼리스트링)은 보통 주소를 통해 데이터를 전달할 때 사용한다.
    - search는 물음표로 시작하고 그 뒤에 키=값 형식으로 데이터를 전달한다.
    - 여러 키가 있을 경우 &로 구분한다.
    - search부분을 다루기 위해 searchParams라는 특수한 객체가 생성된다.

## dns

- DNS를 다룰 때 사용하는 모듈
- 주로 도메인을 통해 IP나 기타 DNS 정보를 얻고자할 때 사용한다.

## crypto

> [https://www.zerocho.com/category/NodeJS/post/593a487c2ed1da0018cff95d](https://www.zerocho.com/category/NodeJS/post/593a487c2ed1da0018cff95d)
> 
- 다양한 방식의 암호화를 도와주는 모듈이다.
- 좀 더 간단하게 암호화하고 싶다면 npm 패키지인 crypto-js를 사용

### 단방향 암호화

- 비밀번호는 보통 단방향 암호화 알고리즘을 사용하여 암호화한다.
- **단방향 암호화란 복호화할 수 없는 암호화 방식**을 의미한다.
    - 복호화는 암호화된 문자열을 원래 문자열로 되돌려놓는 것을 의미한다.
    - 즉, **단방향 암호화는 한번 암호화하면 원래 문자열을 찾을 수 없다.**
    - 복호화할 수 없기 때문에 암호화라고 표현하는 대신 **해시 함수**라고 부르기도 한다.
- 고객 비밀번호의 경우 복호화할 필요가 없기 때문에 단방향을 사용한다.
    - 고객의 비밀번호를 암호화하여 DB에 저장하고, 로그인할 때마다 입력받은 비밀번호를 같은 암호화 알고리즘으로 암호화한 후, DB의 비밀번호와 비교한다.
- 단방향 암호화 알고리즘은 주로 해시 기법을 사용한다.
    - 해시 기법이란 어떤 문자열을 고정된 길이의 다른 문자열로 바꿔버리는 방식
    - **입력 문자열의 길이는 다르지만, 출력 문자열의 길이는 고정되어 있다.**
- 현재는 주로 pbkdf2나 bcrypt, scrypt라는 알고리즘으로 비밀번호를 암호화하고 있다.

### 해시 함수에서 충돌

- 가끔 nopqrst라는 문자열이 qvew로 변환되어 abcdefgh를 넣었을 때와 똑같은 출력 문자열로 바뀔 때도 있다.
    - 이러한 상황을 **충돌**이라고 한다!
- 해킹용 컴퓨터의 역할은 어떤 문자열이 같은 출력 문자열을 반환하는지 찾아내는 것이다.
- **여러 입력 문자열이 같은 출력 문자열로 변환될 수 있기 때문에 비밀번호를 abcdefgh로 설정했어도 nopqrst로 뚫리는 사태가 발생한다.**

### pbkdf2

- node에서 지원하는 알고리즘
- 기존 문자열에 salt라고 불리는 문자열을 붙인 후 해시 알고리즘을 반복해서 적용하는 것

### 양방향 암호화

- 암호화된 문자열을 복호화할 수 있으며, 키가 사용된다.
- **대칭형 암호화에서는 암호를 복호화하려면 암호화할 때 사용한 키와 같은 키를 사용해야 한다.**

## util

- 각종 편의 기능을 모아둔 모듈
- 계속해서 API가 추가되고 있으며, 가끔 deprecated되어 사라지는 경우도 있다.

## worker_threads

- 노드에서 멀티 스레드 방식으로 작업하는 방법
- 멀티 스레딩을 할 땐 일을 나눠서 처리하도록 하는 것이 제일 어렵다.
- 워커 스레드를 많이 사용한다고 해서 많이 빨라지는 것은 아니다!
- 스레드를 생성하고 스레드 사이에서 통신하는데 상당한 비용이 발생하기 때문에 이 점을 고려해야 한다.

## child_process

- 노드에서 **다른 프로그램을 실행하고 싶거나 명령어를 수행**하고 싶을 때 사용하는 모듈이다.
- 해당 모듈을 통해 다른 언어의 코드(ex. 파이썬)을 실행하고 결과값을 받을 수 있다.
- 이름이 child_process인 이유는 **현재 노드 프로세스 외에 새로운 프로세스를 띄워서 명령을 수행하고 노드 프로세스에 결과를 알려주기 때문이다.**

### exec vs spawn

- **exec는 셸을 실행해서 명령어를 수행**하고, **spawn은 새로운 프로세스를 띄우면서 명령어를 실행**한다.
- spawn에서도 세 번째 인수로 `{ shell: true }`를 제공하면 exec처럼 셸을 실행해서 명령어를 수행한다.
    - 셸을 실행하는지 마는지에 따라 수행할 수 있는 명령어에 차이가 있다.
    

## 기타 모듈들

- async_hooks: 비동기 코드의 흐름을 추적할 수 있는 실험적인 모듈이다.
- dgram: UDP와 관련된 작업을 할 때 사용한다.
- net: HTTP보다 로우 레벨인 TCP와 IPC 통신을 할 때 사용한다.
- perf_hooks: 성능 측정할 때 `console.time`보다 더 정교하게 측정한다.
- querystring: `URLSearchParams`가 나오기 이전에 쿼리스트링을 다루기 위해 사용했던 모듈
    - 요즘은 `URLSearchParams`를 사용할 것을 권장한다.
- string_decoder: 버퍼 데이터를 문자열로 바꾸는데 사용한다.
- tls: TLS와 SSL에 관련된 작업을 할 때 사용한다.
- tty: 터미널과 관련된 작업을 할 때 사용한다.
- v8: v8 엔진에 직접 접근할 때 사용한다.
- vm: 가상 머신에 직접 접근할 때 사용한다.
- wasi: 웹 어셈블리를 실행할 때 사용하는 실험적인 모듈이다.